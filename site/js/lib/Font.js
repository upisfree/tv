!function(A){function t(){this.fontFamily="fjs"+(999999*Math.random()|0)}if(!Object.defineProperty)throw"Font.js requires Object.defineProperty, which this browser does not support.";if(!document.createElement("canvas").getContext)throw"Font.js requires <canvas> and the Canvas2D API, which this browser does not support.";!function(A){function t(A,t){return this.slice(A,t)}function e(A,t){var e,o=A.length;for(arguments.length<2&&(t=0),e=0;o>e;++e,++t)this[t]=255&A[e]}function o(A){var o,r;if("number"==typeof A)for(o=new Array(A),r=0;A>r;++r)o[r]=0;else o=A.slice(0);return o.subarray=t,o.buffer=o,o.byteLength=o.length,o.set=e,"object"==typeof A&&A.buffer&&(o.buffer=A.buffer),o}try{{new Uint8Array(1)}return}catch(r){}A.Uint8Array=o,A.Uint32Array=o,A.Int32Array=o}(A),function(A){if(!A.opera&&!("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype)){var t;t=A.VBArray?function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}:function(){this.responseBody},Object.defineProperty(XMLHttpRequest.prototype,"response",{get:t})}}(A),A.btoa||(A.btoa=function(A){var t,e,o,r,n,i,s,a,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,l=0,d="",c=[];if(!A)return A;do t=A.charCodeAt(u++),e=A.charCodeAt(u++),o=A.charCodeAt(u++),a=t<<16|e<<8|o,r=a>>18&63,n=a>>12&63,i=a>>6&63,s=63&a,c[l++]=f.charAt(r)+f.charAt(n)+f.charAt(i)+f.charAt(s);while(u<A.length);d=c.join("");var h=A.length%3;return(h?d.slice(0,h-3):d)+"===".slice(h||3)}),t.prototype.url="",t.prototype.format="",t.prototype.data="",t.prototype.base64="AAEAAAAKAIAAAwAgT1MvMgAAAAAAAACsAAAAWGNtYXAAAAAAAAABBAAAACxnbHlmAAAAAAAAATAAAAAQaGVhZAAAAAAAAAFAAAAAOGhoZWEAAAAAAAABeAAAACRobXR4AAAAAAAAAZwAAAAIbG9jYQAAAAAAAAGkAAAACG1heHAAAAAAAAABrAAAACBuYW1lAAAAAAAAAcwAAAAgcG9zdAAAAAAAAAHsAAAAEAAEAAEAZAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAAMAAQAAAAwABAAgAAAABAAEAAEAAABB//8AAABB////wAABAAAAAAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAAAAAAABfDzz1AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAEAAgAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAAAQAAAAIAAQABAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAHgADAAEECQABAAAAAAADAAEECQACAAIAAAAAAAEAAAAAAAAAAAAAAAAAAA==",t.prototype.metrics={quadsize:0,leading:0,ascent:0,descent:0,weightclass:400},t.prototype.systemfont=!1,t.prototype.loaded=!1,t.prototype.onload=function(){},t.prototype.onerror=function(){},t.prototype.canvas=!1,t.prototype.context=!1,t.prototype.validate=function(A,t,e,o,r){if(r!==!1&&0>r)return void this.onerror("Requested system font '"+this.fontFamily+"' could not be loaded (it may not be installed).");var n=getComputedStyle(A,null).getPropertyValue("width").replace("px","");n>0?(document.head.removeChild(t),document.body.removeChild(A),this.loaded=!0,this.onload()):(console.log("timing out"),setTimeout(function(){o.validate(A,t,e,o,r===!1?!1:r-50)},1e3))},t.prototype.ondownloaded=function(){var A=this,t=function(A){return String.fromCharCode(A)},e=function(A){if(256>A)return t(0)+t(A);var e=A>>8,o=255&A;return t(e)+t(o)},o=function(A,t){return 256*A+t},r=function(A,t){var e,o=A>>7===1;return A=127&A,e=256*A+t,o?e-32768:e},n=function(A,t,e,o){return 16777216*A+65536*t+256*e+o},i=function(t){A.onerror(t)},s=t(0)+t(1)+t(0)+t(0),a="OTTO",f=this.data,u=t(f[0])+t(f[1])+t(f[2])+t(f[3]),l=u===s,d=l?!1:u===a;if(l)this.format="truetype";else{if(!d)return void i("Error: file at "+this.url+" cannot be interpreted as OpenType font.");this.format="opentype"}var c,h,p=o(f[4],f[5]),y=12,m=y+16*p,v={};for(c=y;m>c;c+=16)h=t(f[c])+t(f[c+1])+t(f[c+2])+t(f[c+3]),v[h]={name:h,checksum:n(f[c+4],f[c+5],f[c+6],f[c+7]),offset:n(f[c+8],f[c+9],f[c+10],f[c+11]),length:n(f[c+12],f[c+13],f[c+14],f[c+15])};var b=function(A){return v[A]?A:(i("Error: font is missing the required OpenType '"+A+"' table."),!1)};if(h=b("head"),h!==!1){c=v[h].offset,v[h].version=""+f[c]+f[c+1]+f[c+2]+f[c+3];var g=o(f[c+18],f[c+19]);if(this.metrics.quadsize=g,h=b("hhea"),h!==!1&&(c=v[h].offset,v[h].version=""+f[c]+f[c+1]+f[c+2]+f[c+3],this.metrics.ascent=r(f[c+4],f[c+5])/g,this.metrics.descent=r(f[c+6],f[c+7])/g,this.metrics.leading=r(f[c+8],f[c+9])/g,h=b("OS/2"),h!==!1&&(c=v[h].offset,v[h].version=""+f[c]+f[c+1],this.metrics.weightclass=o(f[c+4],f[c+5]),h=b("cmap"),h!==!1))){c=v[h].offset,v[h].version=""+f[c]+f[c+1],p=o(f[c+2],f[c+3]);for(var w,x,C,E,B,T=!1,w=0;p>w;w++)x=c+4+8*w,C=o(f[x],f[x+1]),E=o(f[x+2],f[x+3]),B=n(f[x+4],f[x+5],f[x+6],f[x+7]),3===C&&1===E&&(T=B);var F="A";if(T!==!1&&(c+=T,u=o(f[c],f[c+1]),4===u)){for(var S=o(f[c+6],f[c+7])/2,q=function(A){return-1===[9,10,11,12,13,32,133,160,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288].indexOf(A)},M=c+14,H=c+14+2*S,Q=!1;H>M&&(Q=o(f[M],f[M+1]),!q(Q));M+=2)Q=!1;if(0!=Q){F=String.fromCharCode(Q);var R=(-(Q-1)+65536)%65536,L=t(0)+e(Q)+e(65535)+e(0)+e(Q)+e(65535)+e(R)+e(1),O=btoa(L);this.base64=this.base64.substring(0,380)+O+this.base64.substring(380+O.length)}}this.bootstrapValidation(F,!1)}}},t.prototype.bootstrapValidation=function(A,t){var e=this.fontFamily+" testfont",o=document.createElement("style");o.setAttribute("type","text/css"),o.innerHTML="@font-face {\n  font-family: '"+e+"';\n  src: url('data:application/x-font-ttf;base64,"+this.base64+"')\n       format('truetype');}",document.head.appendChild(o);var r=!1;this.systemfont||(r=this.toStyleNode(),document.head.appendChild(r));var n=document.createElement("p");if(n.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",n.style.fontFamily="'"+this.fontFamily+"', '"+e+"'",n.innerHTML=A+A+A+A+A+A+A+A+A+A,document.body.appendChild(n),"undefined"==typeof getComputedStyle)this.onload(),error("Error: getComputedStyle is not supported by this browser.\nConsequently, Font.onload() cannot be trusted.");else{var i=this.systemfont?1e3:this.metrics.quadsize,s=document.createElement("canvas");s.width=i,s.height=i,this.canvas=s;var a=s.getContext("2d");a.font="1em '"+this.fontFamily+"'",a.fillStyle="white",a.fillRect(-1,-1,i+2,i+2),a.fillStyle="black",a.fillText("test text",50,i/2),this.context=a;var f=this,u=function(){f.validate(n,o,r,f,t)};setTimeout(u,50)}},t.prototype.processSystemFont=function(){this.systemfont=!0,this.metrics=!1,this.bootstrapValidation("A",1e3)},t.prototype.loadFont=function(){var A=this;if(-1===this.url.indexOf("."))return void setTimeout(function(){A.processSystemFont()},10);var t=new XMLHttpRequest;t.open("GET",A.url,!0),t.responseType="arraybuffer",t.onload=function(){var e=t.response;e?(A.data=new Uint8Array(e),A.ondownloaded()):A.onerror("Error downloading font resource from "+A.url)},t.onerror=function(){A.onerror("Error downloading font resource from "+A.url)},t.send(null)},t.prototype.styleNode=!1,t.prototype.toStyleNode=function(){if(this.styleNode)return this.styleNode;this.styleNode=document.createElement("style"),this.styleNode.type="text/css";var A="@font-face {\n";return A+="  font-family: '"+this.fontFamily+"';\n",A+="  src: url('"+this.url+"') format('"+this.format+"');\n",A+="}",this.styleNode.innerHTML=A,this.styleNode},t.prototype.measureText=function(A,t){if(!this.loaded)return this.onerror("measureText() was called while the font was not yet loaded"),!1;this.context.font=t+"px '"+this.fontFamily+"'";var e=this.context.measureText(A);e.fontsize=t,e.ascent=0,e.descent=0,e.bounds={minx:0,maxx:e.width,miny:0,maxy:0},e.height=0;var o=[],r=e.width/this.metrics.quadsize;o.push(1>=r?A:A);var n,i=o.length;for(n=0;i>n;n++)this.measureSegment(o[n],t,e);return e},t.prototype.measureSegment=function(A,t,e){var o,r=function(A,t){return document.defaultView.getComputedStyle(A,null).getPropertyValue(t)},n=document.createElement("div");n.style.position="absolute",n.style.opacity=0,n.style.font=t+"px '"+this.fontFamily+"'";var i=10;for(n.innerHTML=A,o=1;i>o;o++)n.innerHTML+="<br/>"+A;document.body.appendChild(n),e.leading=1.2*t;var s=r(n,"height");if(s=s.replace("px",""),s>=t*i&&(e.leading=s/i|0),document.body.removeChild(n),/^\s*$/.test(A))return e;var a=(this.canvas,this.context),f=this.systemfont?1e3:this.metrics.quadsize,u=f,l=f,d=f/2,c=50,h=(f-e.width)/2;h!==(0|h)&&(h=0|h),a.fillStyle="white",a.fillRect(-c,-c,u+2*c,l+2*c),a.fillStyle="black",a.fillText(A,h,d);for(var p=e.width+c|0,y=4*t,m=h-c/2,v=d-y/2,b=a.getImageData(m,v,p,y).data,o=0,g=0,w=4*p,x=b.length,C=y/2;++o<x&&255===b[o];);var E=o/w|0;for(o=x-1;--o>0&&255===b[o];);var B=o/w|0;for(o=0,g=0;p>g&&255===b[o];)o+=w,o>=x&&(g++,o=o-x+4);var T=g,F=1;for(o=x-3,g=0;p>g&&255===b[o];)o-=w,0>o&&(g++,o=x-3-4*F++);var S=p-g;return e.ascent=C-E,e.descent=B-C,e.bounds={minx:T-c/2,maxx:S-c/2,miny:-e.descent,maxy:e.ascent},e.height=1+(B-E),e},Object.defineProperty(t.prototype,"src",{set:function(A){this.url=A,this.loadFont()}}),"undefined"!=typeof define?define(function(){return t}):A.Font=t}(window);